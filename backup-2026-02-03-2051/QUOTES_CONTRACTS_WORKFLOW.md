# ğŸ”„ ×–×¨×™××ª ×¢×‘×•×“×” - ××¢×¨×›×ª ×”×¦×¢×•×ª ××—×™×¨ ×•×—×•×–×™×

## ğŸ“Š ××¨×›×™×˜×§×˜×•×¨×” ×›×œ×œ×™×ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        QUOTES & CONTRACTS SYSTEM                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    QUOTES    â”‚â”€â”€â”€â”€â–¶â”‚  CONTRACTS   â”‚â”€â”€â”€â”€â–¶â”‚   INVOICES   â”‚
â”‚ ×”×¦×¢×•×ª ××—×™×¨   â”‚     â”‚    ×—×•×–×™×     â”‚     â”‚  ×—×©×‘×•× ×™×•×ª   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                     â”‚
       â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quote Items  â”‚     â”‚Payment Sched â”‚     â”‚Invoice Pymts â”‚
â”‚  ×¤×¨×™×˜×™×      â”‚     â”‚ ×œ×•×— ×ª×©×œ×•××™×  â”‚     â”‚  ×ª×©×œ×•××™×    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  REMINDERS   â”‚
                     â”‚  ×ª×–×›×•×¨×•×ª     â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ×–×¨×™××” 1: ×™×¦×™×¨×ª ×”×¦×¢×ª ××—×™×¨ â†’ ×—×•×–×”

```
START
  â”‚
  â”œâ”€ 1. ×™×¦×™×¨×ª ×”×¦×¢×ª ××—×™×¨ ×—×“×©×”
  â”‚   â””â”€ ××™×œ×•×™ ×¤×¨×˜×™×: ×œ×§×•×—, ×¤×¨×™×˜, ×›××•×™×•×ª, ××—×™×¨×™×
  â”‚   â””â”€ ×‘×—×™×¨×ª ×ª×‘× ×™×ª ×”×¦×¢×ª ××—×™×¨ (××•×¤×¦×™×•× ×œ×™)
  â”‚   â””â”€ ×”×•×¡×¤×ª ×¤×¨×™×˜×™× (quote_items)
  â”‚   â””â”€ ×—×™×©×•×‘ ××•×˜×•××˜×™: ×¡×›×•××™×, ××¢"×, ×¡×”"×›
  â”‚   â””â”€ ×”×’×“×¨×ª ×ª× ××™ ×ª×©×œ×•×
  â”‚   â””â”€ status: draft
  â”‚
  â”œâ”€ 2. ×¢×¨×™×›×” ×•×ª×¦×•×’×” ××§×“×™××”
  â”‚   â””â”€ ×ª×¦×•×’×ª PDF
  â”‚   â””â”€ ×¢×¨×™×›×ª ×¤×¨×™×˜×™×
  â”‚   â””â”€ ×”×•×¡×¤×ª ×ª× ××™× ×•×”×¢×¨×•×ª
  â”‚
  â”œâ”€ 3. ×©×œ×™×—×ª ×”×¦×¢×ª ××—×™×¨ ×œ×œ×§×•×—
  â”‚   â””â”€ ×™×¦×™×¨×ª PDF
  â”‚   â””â”€ ×©×œ×™×—×ª ××™××™×™×œ ××•×˜×•××˜×™×ª
  â”‚   â””â”€ status: sent
  â”‚   â””â”€ sent_at: timestamp
  â”‚
  â”œâ”€ 4. ××¢×§×‘ ××—×¨ ×”×¦×¢×ª ××—×™×¨
  â”‚   â””â”€ ×œ×§×•×— ×¦×¤×” (viewed_at)
  â”‚   â””â”€ ×ª×–×›×•×¨×•×ª ××•×˜×•××˜×™×•×ª
  â”‚   â””â”€ ××¢×§×‘ ×‘×“×©×‘×•×¨×“
  â”‚
  â”œâ”€ 5. ××™×©×•×¨ ×”×¦×¢×ª ××—×™×¨
  â”‚   â”œâ”€ ×œ×§×•×— ×××©×¨
  â”‚   â”‚  â””â”€ ×—×ª×™××” ×“×™×’×™×˜×œ×™×ª (××•×¤×¦×™×•× ×œ×™)
  â”‚   â”‚  â””â”€ status: accepted
  â”‚   â”‚  â””â”€ signed_date: today
  â”‚   â”‚
  â”‚   â””â”€ ×”××¨×” ×œ×—×•×–×” ×™×“× ×™×ª/××•×˜×•××˜×™×ª
  â”‚       â””â”€ convert_quote_to_contract()
  â”‚       â””â”€ ×™×¦×™×¨×ª ×¨×©×•××” ×‘contracts
  â”‚       â””â”€ ×”×¢×ª×§×ª ×›×œ ×”× ×ª×•× ×™×
  â”‚       â””â”€ ×§×™×©×•×¨: quote.converted_to_contract_id
  â”‚
  â”œâ”€ 6. ×™×¦×™×¨×ª ×—×•×–×”
  â”‚   â””â”€ ××™×œ×•×™ ×¤×¨×˜×™× × ×•×¡×¤×™×:
  â”‚   â”‚  â”œâ”€ ×ª××¨×™×š ×”×ª×—×œ×”/×¡×™×•×
  â”‚   â”‚  â”œâ”€ ×ª× ××™ ×ª×©×œ×•× ××¤×•×¨×˜×™×
  â”‚   â”‚  â”œâ”€ ××¡××›×™× × ×•×¡×¤×™×
  â”‚   â”‚  â””â”€ ×—×ª×™××•×ª
  â”‚   â”‚
  â”‚   â””â”€ status: active
  â”‚   â””â”€ signed_date: today
  â”‚
  â””â”€ 7. ×”×’×“×¨×ª ×œ×•×— ×ª×©×œ×•××™×
      â””â”€ create_payment_schedule()
      â””â”€ ××¡×¤×¨ ×ª×©×œ×•××™×: 1, 2, 3...
      â””â”€ ×ª×“×™×¨×•×ª: ×—×•×“×©×™×ª, ×¨×‘×¢×•× ×™×ª, ×•×›×•'
      â””â”€ ×¡×›×•××™×: ×©×•×•×™× ××• ××•×ª×××™× ××™×©×™×ª
      â””â”€ ×ª××¨×™×›×™ ×™×¢×“
      â””â”€ ×™×¦×™×¨×ª ×¨×©×•××•×ª ×‘payment_schedules

END
```

---

## ğŸ’° ×–×¨×™××” 2: × ×™×”×•×œ ×ª×©×œ×•××™×

```
START (×—×•×–×” ×¤×¢×™×œ ×¢× ×œ×•×— ×ª×©×œ×•××™×)
  â”‚
  â”œâ”€ 1. ××¢×§×‘ ××•×˜×•××˜×™ ×™×•××™
  â”‚   â””â”€ check_overdue_payments() - ×¨×¥ ×™×•××™
  â”‚   â””â”€ ×‘×“×™×§×ª ×ª×©×œ×•××™× ×©×¢×‘×¨×• ×ª××¨×™×š ×™×¢×“
  â”‚   â””â”€ ×¢×“×›×•×Ÿ status: overdue
  â”‚
  â”œâ”€ 2. ×ª×–×›×•×¨×•×ª ××•×˜×•××˜×™×•×ª
  â”‚   â”œâ”€ ×ª×–×›×•×¨×ª 1: 7 ×™××™× ×œ×¤× ×™
  â”‚   â”‚  â””â”€ ×©×œ×™×—×ª ××™××™×™×œ
  â”‚   â”‚  â””â”€ ×”×ª×¨××ª ×“×¤×“×¤×Ÿ
  â”‚   â”‚  â””â”€ reminder_count++
  â”‚   â”‚
  â”‚   â”œâ”€ ×ª×–×›×•×¨×ª 2: 3 ×™××™× ×œ×¤× ×™
  â”‚   â”‚  â””â”€ ×©×œ×™×—×ª ××™××™×™×œ + SMS
  â”‚   â”‚  â””â”€ ×”×ª×¨××” ×œ×‘×¢×œ×™×
  â”‚   â”‚
  â”‚   â”œâ”€ ×ª×–×›×•×¨×ª 3: ×™×•× ×œ×¤× ×™
  â”‚   â”‚  â””â”€ ××™××™×™×œ ×“×—×•×£
  â”‚   â”‚  â””â”€ ×•×•××˜×¡××¤ (××•×¤×¦×™×•× ×œ×™)
  â”‚   â”‚
  â”‚   â””â”€ ×ª×–×›×•×¨×ª 4: ×‘×™×•× ×”×ª×©×œ×•×
  â”‚       â””â”€ ×”×•×“×¢×” ×“×—×•×¤×”
  â”‚       â””â”€ ×©×™×—×” ×˜×œ×¤×•× ×™×ª ××•××œ×¦×ª
  â”‚
  â”œâ”€ 3. ×™×¦×™×¨×ª ×—×©×‘×•× ×™×ª ××•×˜×•××˜×™×ª
  â”‚   â””â”€ ×‘×™×•× ×”×™×¢×“ ××• ×œ×¤×™ ×‘×§×©×”
  â”‚   â””â”€ create_invoice_from_schedule()
  â”‚   â””â”€ ×™×¦×™×¨×ª invoice
  â”‚   â””â”€ ×§×™×©×•×¨ invoice_id â† payment_schedule
  â”‚   â””â”€ ×¢×“×›×•×Ÿ status: sent
  â”‚   â””â”€ ×©×œ×™×—×ª ×—×©×‘×•× ×™×ª ×œ×œ×§×•×—
  â”‚
  â”œâ”€ 4. ×§×‘×œ×ª ×ª×©×œ×•×
  â”‚   â”œâ”€ ××•×¤×¦×™×” A: ×¨×™×©×•× ×™×“× ×™
  â”‚   â”‚  â””â”€ ×¤×ª×™×—×ª "×¡××Ÿ ×›×©×•×œ×"
  â”‚   â”‚  â””â”€ ××™×œ×•×™ ×¤×¨×˜×™ ×ª×©×œ×•×
  â”‚   â”‚  â””â”€ paid_date, payment_method
  â”‚   â”‚  â””â”€ status: paid
  â”‚   â”‚
  â”‚   â””â”€ ××•×¤×¦×™×” B: ×¡× ×›×¨×•×Ÿ ××•×˜×•××˜×™
  â”‚       â””â”€ ×§×™×©×•×¨ ×œ×—×©×‘×•×Ÿ ×‘× ×§
  â”‚       â””â”€ ×–×™×”×•×™ ×ª×©×œ×•× ××•×˜×•××˜×™
  â”‚       â””â”€ ×¢×“×›×•×Ÿ ××•×˜×•××˜×™
  â”‚
  â”œâ”€ 5. ×¢×“×›×•×Ÿ ×¡×˜×˜×•×¡×™×
  â”‚   â””â”€ payment_schedule.paid_amount += amount
  â”‚   â””â”€ payment_schedule.status = paid
  â”‚   â””â”€ invoice.paid_amount += amount
  â”‚   â””â”€ invoice.status = paid
  â”‚   â””â”€ contract â†’ ×‘×“×™×§×”
  â”‚
  â”œâ”€ 6. ×‘×“×™×§×ª ×”×©×œ××ª ×—×•×–×”
  â”‚   â””â”€ update_contract_status() - Trigger
  â”‚   â””â”€ ×¡×¤×™×¨×ª ×ª×©×œ×•××™× ×©×©×•×œ××•
  â”‚   â””â”€ if (all_paid) {
  â”‚   â”‚    contract.status = completed
  â”‚   â”‚    sent_completion_email()
  â”‚   â”‚  }
  â”‚
  â””â”€ 7. ×¡×™×•× ×—×•×–×”
      â””â”€ status: completed
      â””â”€ ×™×¦×™×¨×ª ×¡×™×›×•× ×¤×™× × ×¡×™
      â””â”€ ×©××™×¨×ª ××¡××›×™×
      â””â”€ ×”×•×“×¢×” ×œ×œ×§×•×—

END
```

---

## ğŸ“§ ×–×¨×™××” 3: ×ª×–×›×•×¨×•×ª ×•××•×˜×•××¦×™×”

```
CRON JOB - ×¨×¥ ×™×•××™ ×‘×©×¢×” 08:00

START
  â”‚
  â”œâ”€ 1. ×‘×“×™×§×ª ×ª×©×œ×•××™× ×§×¨×•×‘×™×
  â”‚   â””â”€ SELECT * FROM payment_schedules
  â”‚       WHERE status = 'pending'
  â”‚       AND due_date BETWEEN today AND today+7
  â”‚
  â”œâ”€ 2. ×¡×™×•×•×’ ×œ×¤×™ ×“×—×™×¤×•×ª
  â”‚   â”œâ”€ Overdue (×¢×‘×¨ ×ª××¨×™×š)
  â”‚   â”‚  â””â”€ priority: URGENT
  â”‚   â”‚  â””â”€ color: RED
  â”‚   â”‚
  â”‚   â”œâ”€ Due Today (×”×™×•×)
  â”‚   â”‚  â””â”€ priority: HIGH
  â”‚   â”‚  â””â”€ color: ORANGE
  â”‚   â”‚
  â”‚   â”œâ”€ Due Tomorrow (××—×¨)
  â”‚   â”‚  â””â”€ priority: MEDIUM
  â”‚   â”‚  â””â”€ color: YELLOW
  â”‚   â”‚
  â”‚   â””â”€ Due in 3-7 days
  â”‚       â””â”€ priority: LOW
  â”‚       â””â”€ color: BLUE
  â”‚
  â”œâ”€ 3. ×‘× ×™×™×ª ×”×•×“×¢×•×ª ××•×ª×××•×ª ××™×©×™×ª
  â”‚   â””â”€ ×˜×¢×™× ×ª template ××ª×•×š email_templates
  â”‚   â””â”€ ×”×—×œ×¤×ª ××©×ª× ×™×:
  â”‚   â”‚  â”œâ”€ {{clientName}}
  â”‚   â”‚  â”œâ”€ {{amount}}
  â”‚   â”‚  â”œâ”€ {{dueDate}}
  â”‚   â”‚  â”œâ”€ {{contractTitle}}
  â”‚   â”‚  â”œâ”€ {{paymentNumber}}
  â”‚   â”‚  â””â”€ {{companyName}}
  â”‚   â”‚
  â”‚   â””â”€ ×”×•×¡×¤×ª ×§×™×©×•×¨ ×œ×ª×©×œ×•×
  â”‚   â””â”€ ×”×•×¡×¤×ª ×¤×¨×˜×™ ×”×¢×‘×¨×” ×‘× ×§××™×ª
  â”‚
  â”œâ”€ 4. ×©×œ×™×—×ª ×ª×–×›×•×¨×•×ª
  â”‚   â”œâ”€ ××™××™×™×œ
  â”‚   â”‚  â””â”€ send-reminder-email function
  â”‚   â”‚  â””â”€ tracking pixel
  â”‚   â”‚  â””â”€ ×œ×•×’ ×‘email_logs
  â”‚   â”‚
  â”‚   â”œâ”€ SMS (××•×¤×¦×™×•× ×œ×™)
  â”‚   â”‚  â””â”€ Twilio integration
  â”‚   â”‚  â””â”€ ×”×•×“×¢×” ×§×¦×¨×”
  â”‚   â”‚
  â”‚   â”œâ”€ WhatsApp (××•×¤×¦×™×•× ×œ×™)
  â”‚   â”‚  â””â”€ WhatsApp Business API
  â”‚   â”‚  â””â”€ ×”×•×“×¢×” + ×§×™×©×•×¨
  â”‚   â”‚
  â”‚   â””â”€ ×”×ª×¨××ª ×“×¤×“×¤×Ÿ
  â”‚       â””â”€ Web Push Notification
  â”‚       â””â”€ ×¨×§ ×œ××©×ª××©×™× ××—×•×‘×¨×™×
  â”‚
  â”œâ”€ 5. ×¢×“×›×•×Ÿ ××•× ×™×
  â”‚   â””â”€ payment_schedules.reminder_count++
  â”‚   â””â”€ payment_schedules.reminder_sent_at = now()
  â”‚   â””â”€ payment_schedules.next_reminder_date = due_date - 3 days
  â”‚
  â”œâ”€ 6. ×™×¦×™×¨×ª Activity Log
  â”‚   â””â”€ ×¨×™×©×•× ×‘activity_log:
  â”‚   â”‚  â”œâ”€ action: payment_reminder_sent
  â”‚   â”‚  â”œâ”€ entity_type: payment_schedule
  â”‚   â”‚  â”œâ”€ entity_id: schedule_id
  â”‚   â”‚  â””â”€ details: {channel, priority, ...}
  â”‚
  â””â”€ 7. ×“×™×•×•×— ×œ×× ×”×œ×™×
      â””â”€ ×©×œ×™×—×ª ×¡×™×›×•× ×™×•××™:
      â”‚  â”œâ”€ ×ª×©×œ×•××™× ×©× ×©×œ×—×• ×ª×–×›×•×¨×•×ª
      â”‚  â”œâ”€ ×ª×©×œ×•××™× ×‘××™×—×•×¨
      â”‚  â”œâ”€ ×ª×©×œ×•××™× ×¦×¤×•×™×™× ×”×™×•×
      â”‚  â””â”€ ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª
      â”‚
      â””â”€ Dashboard update
         â””â”€ ×¢×“×›×•×Ÿ ××¡×¤×¨×™× ×‘×–××Ÿ ×××ª

END
```

---

## ğŸ‘¥ ×–×¨×™××” 4: ×¤×•×¨×˜×œ ×œ×§×•×—×•×ª

```
CLIENT LOGIN
  â”‚
  â”œâ”€ 1. Dashboard
  â”‚   â”œâ”€ ×—×•×–×™× ×¤×¢×™×œ×™× ×©×œ×™
  â”‚   â”œâ”€ ×ª×©×œ×•××™× ×”×‘××™× (3 ×§×¨×•×‘×™×)
  â”‚   â”œâ”€ ×”×™×¡×˜×•×¨×™×™×ª ×ª×©×œ×•××™×
  â”‚   â””â”€ ××¡××›×™× ×œ×”×•×¨×“×”
  â”‚
  â”œâ”€ 2. ×”×¦×¢×•×ª ××—×™×¨ ×©×œ×™
  â”‚   â”œâ”€ ×¨×©×™××ª ×”×¦×¢×•×ª
  â”‚   â”œâ”€ ×¡×˜×˜×•×¡ ×›×œ ×”×¦×¢×”
  â”‚   â”œâ”€ ×¦×¤×™×™×” ×‘×”×¦×¢×”
  â”‚   â””â”€ ××™×©×•×¨/×“×—×™×™×”
  â”‚       â””â”€ ×—×ª×™××” ×“×™×’×™×˜×œ×™×ª
  â”‚
  â”œâ”€ 3. ×”×—×•×–×™× ×©×œ×™
  â”‚   â”œâ”€ ×¤×¨×˜×™ ×—×•×–×”
  â”‚   â”œâ”€ ×œ×•×— ×ª×©×œ×•××™×
  â”‚   â”œâ”€ ××¡××›×™×
  â”‚   â””â”€ ×”×™×¡×˜×•×¨×™×™×ª ×©×™× ×•×™×™×
  â”‚
  â”œâ”€ 4. ×”×ª×©×œ×•××™× ×©×œ×™
  â”‚   â”œâ”€ ×ª×©×œ×•××™× ×××ª×™× ×™×
  â”‚   â”‚  â””â”€ ×”×•×¨×“×ª ×—×©×‘×•× ×™×ª
  â”‚   â”‚  â””â”€ ×¤×¨×˜×™ ×”×¢×‘×¨×” ×‘× ×§××™×ª
  â”‚   â”‚  â””â”€ ×ª×©×œ×•× ××•× ×œ×™×™×Ÿ (×¢×ª×™×“×™)
  â”‚   â”‚
  â”‚   â”œâ”€ ×ª×©×œ×•××™× ×©×©×•×œ××•
  â”‚   â”‚  â””â”€ ×”×™×¡×˜×•×¨×™×” ××œ××”
  â”‚   â”‚  â””â”€ ×”×•×¨×“×ª ×§×‘×œ×•×ª
  â”‚   â”‚
  â”‚   â””â”€ ×“×•×—×•×ª
  â”‚       â””â”€ ×“×•×— ×©× ×ª×™
  â”‚       â””â”€ ×™×™×¦×•× Excel
  â”‚
  â”œâ”€ 5. ×”×•×“×¢×•×ª
  â”‚   â””â”€ ×ª×–×›×•×¨×•×ª ×ª×©×œ×•×
  â”‚   â””â”€ ×¢×“×›×•× ×™ ×—×•×–×”
  â”‚   â””â”€ ×”×•×“×¢×•×ª ××”××¢×¨×›×ª
  â”‚
  â””â”€ 6. ×¤× ×™×•×ª
      â””â”€ ×‘×§×©×” ×œ×”× ×¤×§×ª ×—×©×‘×•× ×™×ª
      â””â”€ ×©××œ×•×ª ×¢×œ ×—×•×–×”
      â””â”€ ×‘×§×©×” ×œ×“×—×™×™×ª ×ª×©×œ×•×

END
```

---

## ğŸ“Š ×–×¨×™××” 5: ×“×©×‘×•×¨×“ ×× ×”×œ×™×

```
MANAGER DASHBOARD
  â”‚
  â”œâ”€ 1. ×¡×§×™×¨×” ×›×œ×œ×™×ª
  â”‚   â”œâ”€ ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª
  â”‚   â”‚  â”œâ”€ ×—×•×–×™× ×¤×¢×™×œ×™×: 24
  â”‚   â”‚  â”œâ”€ ×¢×¨×š ×—×•×–×™×: â‚ª1,250,000
  â”‚   â”‚  â”œâ”€ ×ª×©×œ×•××™× ×”×—×•×“×©: â‚ª180,000
  â”‚   â”‚  â””â”€ ×‘××™×—×•×¨: â‚ª15,000 (2)
  â”‚   â”‚
  â”‚   â””â”€ ğŸ“ˆ ×’×¨×¤×™×
  â”‚       â”œâ”€ ×ª×–×¨×™× ××–×•×× ×™× ×—×–×•×™
  â”‚       â”œâ”€ ×ª×©×œ×•××™× ×œ×¤×™ ×—×•×“×©
  â”‚       â””â”€ ×”×ª×¤×œ×’×•×ª ×¡×˜×˜×•×¡ ×—×•×–×™×
  â”‚
  â”œâ”€ 2. ×”×ª×¨××•×ª
  â”‚   â”œâ”€ ğŸ”´ ×ª×©×œ×•××™× ×‘××™×—×•×¨ (2)
  â”‚   â”œâ”€ ğŸŸ  ×ª×©×œ×•××™× ×”×™×•× (3)
  â”‚   â”œâ”€ ğŸŸ¡ ×ª×©×œ×•××™× ×”×©×‘×•×¢ (8)
  â”‚   â””â”€ ğŸ”µ ×—×•×–×™× ×©××¡×ª×™×™××™× ×”×—×•×“×© (2)
  â”‚
  â”œâ”€ 3. ×ª×©×œ×•××™× ×”×©×‘×•×¢
  â”‚   â””â”€ ×¨×©×™××ª 10 ×ª×©×œ×•××™× ×§×¨×•×‘×™×
  â”‚       â”œâ”€ ×œ×§×•×—
  â”‚       â”œâ”€ ×¡×›×•×
  â”‚       â”œâ”€ ×ª××¨×™×š ×™×¢×“
  â”‚       â”œâ”€ ×¡×˜×˜×•×¡
  â”‚       â””â”€ ×¤×¢×•×œ×•×ª ××”×™×¨×•×ª:
  â”‚           â”œâ”€ ×©×œ×— ×ª×–×›×•×¨×ª
  â”‚           â”œâ”€ ×¦×•×¨ ×—×©×‘×•× ×™×ª
  â”‚           â””â”€ ×¡××Ÿ ×›×©×•×œ×
  â”‚
  â”œâ”€ 4. ×—×•×–×™× ×¤×¢×™×œ×™×
  â”‚   â””â”€ ×˜×‘×œ×” ×¢× ×¤×™×œ×˜×¨×™×
  â”‚       â”œâ”€ ×¡×™× ×•×Ÿ ×œ×¤×™ ×œ×§×•×—
  â”‚       â”œâ”€ ×¡×™× ×•×Ÿ ×œ×¤×™ ×¡×˜×˜×•×¡
  â”‚       â”œâ”€ ×¡×™× ×•×Ÿ ×œ×¤×™ ×ª××¨×™×š
  â”‚       â””â”€ ×—×™×¤×•×© ×—×•×¤×©×™
  â”‚
  â”œâ”€ 5. × ×™×ª×•×— ×¤×™× × ×¡×™
  â”‚   â”œâ”€ ×ª×–×¨×™× ××–×•×× ×™× ×¦×¤×•×™
  â”‚   â”‚  â””â”€ ×—×–×•×™ ×œ-6 ×—×•×“×©×™×
  â”‚   â”‚
  â”‚   â”œâ”€ ×”×©×•×•××” ×œ×ª×§×¦×™×‘
  â”‚   â”‚  â””â”€ ×™×¢×“ vs ×‘×™×¦×•×¢
  â”‚   â”‚
  â”‚   â””â”€ ××“×“×™ ×‘×™×¦×•×¢
  â”‚       â”œâ”€ % ×ª×©×œ×•××™× ×‘×–××Ÿ
  â”‚       â”œâ”€ ×××•×¦×¢ ×–××Ÿ ×’×‘×™×™×”
  â”‚       â””â”€ × ××× ×•×ª ×œ×§×•×—
  â”‚
  â””â”€ 6. ×¤×¢×•×œ×•×ª ××”×™×¨×•×ª
      â”œâ”€ ×¦×•×¨ ×”×¦×¢×ª ××—×™×¨ ×—×“×©×”
      â”œâ”€ ×¦×•×¨ ×—×•×–×” ×—×“×©
      â”œâ”€ ×¨×©×•× ×ª×©×œ×•×
      â”œâ”€ ×©×œ×— ×ª×–×›×•×¨×•×ª ×œ×›×•×œ×
      â””â”€ ×™×™×¦× ×“×•×—

END
```

---

## ğŸ”„ ×–×¨×™××” 6: ×¢×“×›×•× ×™× ×•×¡× ×›×¨×•× ×™×

```
REAL-TIME SYNC
  â”‚
  â”œâ”€ 1. ×¢×“×›×•×Ÿ ×ª×©×œ×•×
  â”‚   â””â”€ User marks payment as paid
  â”‚   â””â”€ UPDATE payment_schedules
  â”‚   â””â”€ TRIGGER: update_contract_status
  â”‚   â””â”€ UPDATE invoices
  â”‚   â””â”€ CHECK: all payments done?
  â”‚   â””â”€ IF YES:
  â”‚       â”œâ”€ UPDATE contracts.status = completed
  â”‚       â”œâ”€ SEND completion email
  â”‚       â””â”€ CREATE activity log
  â”‚
  â”œâ”€ 2. ×¢×“×›×•×Ÿ ×—×©×‘×•× ×™×ª
  â”‚   â””â”€ Invoice payment received
  â”‚   â””â”€ TRIGGER: update_invoice_paid_amount
  â”‚   â””â”€ UPDATE invoice.paid_amount
  â”‚   â””â”€ FIND related payment_schedule
  â”‚   â””â”€ UPDATE payment_schedule.status = paid
  â”‚   â””â”€ CASCADE to contract
  â”‚
  â”œâ”€ 3. ×¡× ×›×¨×•×Ÿ ×¢× ×—×©×‘×•× ×™×ª ×™×¨×•×§×”
  â”‚   â””â”€ Invoice created
  â”‚   â””â”€ IF green_invoice_enabled:
  â”‚       â”œâ”€ POST to Green Invoice API
  â”‚       â”œâ”€ SAVE green_invoice_id
  â”‚       â”œâ”€ GET PDF URL
  â”‚       â””â”€ SAVE pdf_storage_url
  â”‚
  â”œâ”€ 4. ×¢×“×›×•×Ÿ ×¡×˜×˜×•×¡×™ ×—×•×–×”
  â”‚   â””â”€ Daily CRON job
  â”‚   â””â”€ CHECK: end_date passed?
  â”‚   â””â”€ IF YES:
  â”‚       â””â”€ UPDATE status = expired
  â”‚
  â””â”€ 5. ×¡× ×›×¨×•×Ÿ ×‘×™×Ÿ ××›×©×™×¨×™×
      â””â”€ Realtime subscriptions (Supabase)
      â””â”€ User A updates â†’ User B sees immediately
      â””â”€ Push notifications to mobile
      â””â”€ Email notifications

END
```

---

## ğŸ“‹ Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATA FLOW                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

QUOTES TABLE                    CONTRACTS TABLE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ quote_id     â”‚
â”‚ quote_number â”‚               â”‚ contract_num â”‚
â”‚ client_id    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ client_id    â”‚
â”‚ total_amount â”‚               â”‚ value        â”‚
â”‚ status       â”‚               â”‚ status       â”‚
â”‚ converted_to â”‚â”€â”€â”€â”           â”‚ signed_date  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                   â”‚
                   â”‚                   â”‚
         QUOTE_ITEMS                   â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
         â”‚ quote_id     â”‚              â”‚
         â”‚ description  â”‚              â”‚
         â”‚ quantity     â”‚              â”‚
         â”‚ unit_price   â”‚              â”‚
         â”‚ subtotal     â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
                                       â”‚
                                       â–¼
                            PAYMENT_SCHEDULES TABLE
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ contract_id  â”‚
                            â”‚ payment_num  â”‚
                            â”‚ amount       â”‚
                            â”‚ due_date     â”‚
                            â”‚ status       â”‚
                            â”‚ invoice_id   â”‚â”€â”€â”€â”
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                                               â”‚
                                               â–¼
                                    INVOICES TABLE
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ id           â”‚
                                    â”‚ contract_id  â”‚
                                    â”‚ amount       â”‚
                                    â”‚ status       â”‚
                                    â”‚ paid_amount  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                    INVOICE_PAYMENTS
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ invoice_id   â”‚
                                    â”‚ amount       â”‚
                                    â”‚ payment_date â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CLIENTS TABLE                    REMINDERS TABLE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ entity_id    â”‚
â”‚ name         â”‚               â”‚ entity_type  â”‚
â”‚ email        â”‚               â”‚ remind_at    â”‚
â”‚ phone        â”‚               â”‚ status       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Integration Points

### 1. Quote â†’ Contract
```typescript
async function convertQuoteToContract(quoteId: uuid) {
  const quote = await getQuote(quoteId);
  
  const contract = await createContract({
    quote_id: quoteId,
    client_id: quote.client_id,
    title: quote.title,
    contract_value: quote.total_amount,
    // ... more fields
  });
  
  await updateQuote(quoteId, {
    status: 'converted',
    converted_to_contract_id: contract.id
  });
  
  return contract;
}
```

### 2. Payment Schedule â†’ Invoice
```typescript
async function createInvoiceFromSchedule(scheduleId: uuid) {
  const schedule = await getPaymentSchedule(scheduleId);
  const contract = await getContract(schedule.contract_id);
  
  const invoice = await createInvoice({
    contract_id: contract.id,
    client_id: contract.client_id,
    amount: schedule.amount,
    due_date: schedule.due_date,
    description: `${contract.title} - ×ª×©×œ×•× ${schedule.payment_number}`
  });
  
  await updateSchedule(scheduleId, {
    invoice_id: invoice.id,
    status: 'sent'
  });
  
  return invoice;
}
```

### 3. Payment Received â†’ Update Chain
```typescript
async function recordPayment(scheduleId: uuid, amount: number) {
  // 1. Update payment schedule
  await updateSchedule(scheduleId, {
    paid_amount: amount,
    status: amount >= schedule.amount ? 'paid' : 'partial',
    paid_date: new Date()
  });
  
  // 2. Update invoice
  if (schedule.invoice_id) {
    await updateInvoice(schedule.invoice_id, {
      paid_amount: amount,
      status: 'paid'
    });
  }
  
  // 3. Check if contract completed
  const allSchedules = await getContractSchedules(schedule.contract_id);
  const allPaid = allSchedules.every(s => s.status === 'paid');
  
  if (allPaid) {
    await updateContract(schedule.contract_id, {
      status: 'completed'
    });
    
    await sendCompletionEmail(schedule.contract_id);
  }
}
```

---

**×”×ª×¨×©×™× ××¡×¤×§:**
âœ… ×”×‘× ×” ×•×™×–×•××œ×™×ª ×©×œ ×”×–×¨×™××•×ª
âœ… ×§×™×©×•×¨×™× ×‘×™×Ÿ ×˜×‘×œ××•×ª
âœ… ×ª×”×œ×™×›×™× ××•×˜×•××˜×™×™×
âœ… × ×§×•×“×•×ª ××™× ×˜×’×¨×¦×™×”
âœ… ×“×•×’×××•×ª ×§×•×“

**×”×× ×œ×”××©×™×š ×œ×™×™×©×•×?** ğŸš€
