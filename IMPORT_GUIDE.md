# מדריך ייבוא אנשי קשר מקובץ CSV

## 🎯 איפה למצוא את מערכת הייבוא?

### ✅ מיקום חדש ומרכזי:
```
תפריט ראשי → ייבוא נתונים → טאב "ייבוא אנשי קשר"
```

**הכול במקום אחד!**
- ✅ ייבוא אנשי קשר מ-CSV (Google Contacts)
- ✅ ייבוא גיבוי מלא (לקוחות, פרויקטים, זמנים)
- ✅ ניהול כפילויות חכם
- ✅ תצוגה מקדימה ומיפוי עמודות

---

## איך לייבא אנשי קשר?

### שלב 1: גישה למערכת הייבוא
1. לחץ על **"ייבוא נתונים"** בתפריט הראשי
2. בחר בטאב **"ייבוא אנשי קשר"** (למעלה)

### שלב 2: העלאת הקובץ
1. לחץ על **"בחר קובץ CSV"**
2. בחר את הקובץ שייצאת מ-Google Contacts
3. המערכת תנתח את הקובץ אוטומטית

### שלב 3: מיפוי עמודות (אוטומטי)
המערכת תזהה אוטומטית את העמודות:
- **First Name / שם פרטי** → יזהה עמודות: "First Name", "Given Name", "שם פרטי"
- **Last Name / שם משפחה** → יזהה עמודות: "Last Name", "Family Name", "שם משפחה"  
- **E-mail / מייל** → יזהה עמודות: "E-mail", "E-mail Address", "Email", "דוא\"ל"
- **Phone / טלפון** → יזהה עמודות: "Mobile Phone", "Phone", "Primary Phone", "טלפון נייד"
- **Organization / ארגון** → יזהה עמודות: "Company", "Organization", "ארגון", "חברה"

אם הזיהוי האוטומטי לא מדויק, אפשר לשנות ידנית.

### שלב 4: תצוגה מקדימה וזיהוי כפילויות
- **תצוגת כרטיסים / רשימה** - בחר את התצוגה המועדפת
- **סינון חכם**:
  - 📧 יש מייל
  - 📞 יש טלפון
  - 🏢 יש ארגון
  - ⚠️ כפילויות
  - ✨ חדשים

### זיהוי כפילויות - שני מישורים:

#### 🔍 1. כפילויות מול מסד הנתונים (אנשי קשר קיימים)
1. **כפילות לפי מייל** - אם יש איש קשר עם אותו מייל במערכת
2. **כפילות לפי טלפון** - אם יש איש קשר עם אותו טלפון (מנורמל)
3. **כפילות לפי שם** - אם יש איש קשר עם שם זהה
   - **סימון**: תג צהוב "קיים במערכת"

#### 🔍 2. כפילויות פנימיות בקובץ (NEW!)
- **זיהוי שורות כפולות בתוך הקובץ עצמו**
- **מציג את מספר השורה המקורית**
- **סימון**: תג כתום "כפילות בקובץ"
- **הערה אוטומטית**: "⚠️ כפילות פנימית בקובץ (שורה XX)"

**דוגמה לכפילות פנימית**:
```csv
שורה 1: יוסי כהן, yossi@example.com, 050-1234567
שורה 2: דני לוי, danny@example.com, 050-9876543
שורה 3: יוסי כהן, yossi@example.com, 050-1234567  ← כפילות פנימית!
```
שורה 3 תסומן כ"כפילות פנימית - שורה 1"

### שלב 5: ניהול כפילויות
עבור כל כפילות יש 3 אפשרויות:
- **דלג** - לא לייבא (ברירת מחדל)
- **עדכן** - עדכן את הרשומה הקיימת (טלפון משני, הערות, וכו')
- **ייבא בכל זאת** - צור רשומה חדשה

### שלב 6: ייבוא
1. בחר את האנשי קשר לייבוא (או "בחר הכל")
2. לחץ **"ייבא X אנשי קשר"**
3. המערכת תציג התקדמות בזמן אמת
4. במקרה של שגיאה - אפשר להמשיך מאיפה שעצרת!

## פורמטים נתמכים

### Google Contacts CSV
הפורמט המומלץ! ייצוא מ-Google Contacts:
1. היכנס ל-https://contacts.google.com
2. לחץ על **Export**
3. בחר **Google CSV**
4. הורד את הקובץ

### עמודות נתמכות:
- First Name, Middle Name, Last Name
- E-mail Address, E-mail 2 Address, E-mail 3 Address
- Primary Phone, Home Phone, Mobile Phone, Business Phone
- Organization, Job Title, Department
- Birthday, Notes, Categories/Labels

## תכונות מתקדמות

### 📊 סטטיסטיקות
המערכת מציגה בזמן אמת:
- סה"כ אנשי קשר בקובץ
- כמה נבחרו
- כמה כפילויות
- כמה כבר יובאו
- כמה לעדכון

### 🔍 חיפוש
חפש לפי:
- שם
- מייל
- טלפון
- ארגון

### 🎯 סינון חכם
5 פילטרים שונים לסינון מהיר

### 💾 המשך ייבוא
אם הייבוא נקטע:
- המערכת שומרת את המצב
- אפשר להמשיך מהרשומה האחרונה
- תקף ל-24 שעות

### 📤 ייצוא
ייצא את התוצאות ב-3 פורמטים:
- CSV
- JSON
- vCard (לייבוא לטלפון)

## פתרון בעיות

### הקובץ לא נטען
- ✅ וודא שהקובץ בפורמט CSV (לא Excel)
- ✅ וודא שהקובץ מקודד ב-UTF-8
- ✅ נסה לפתוח ב-Notepad ולשמור שוב

### לא מוצאים עמודות
- ✅ בדוק שיש שורת כותרות בקובץ
- ✅ שנה את המיפוי ידנית

### כפילויות לא מזוהות
- ✅ המערכת משווה טלפונים ללא רווחים/מקפים
- ✅ שמות מושווים ללא הבדל אותיות גדולות/קטנות
- ✅ מיילים מושווים בדיוק

### הייבוא איטי
- ✅ זה תקין - המערכת בודקת כל רשומה מול הבסיס נתונים
- ✅ עבור 100+ אנשי קשר צפוי זמן של 1-2 דקות

## דוגמת קובץ CSV

```csv
First Name,Last Name,E-mail Address,Mobile Phone,Company
יוסי,כהן,yossi@example.com,050-1234567,חברת ABC
משה,לוי,moshe@example.com,054-9876543,
שרה,גרין,sarah@example.com,052-5555555,חברת XYZ
```

## תמיכה נוספת
במקרה של בעיה:
1. בדוק את לוג השגיאות בקונסול
2. שמור את הקובץ לבדיקה
3. פנה לתמיכה עם הפרטים

---

**עודכן:** 22.1.2026
**גרסה:** 2.0 - עם תמיכה מלאה בכפילויות וייבוא מתקדם
